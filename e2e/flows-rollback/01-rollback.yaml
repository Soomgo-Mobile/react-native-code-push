appId: ${APP_ID}
---
# App should have the update installed from phase 1
- launchApp
- runFlow:
    when:
      platform: Android
    file: ../flows/shared/android-dismiss-overlays.yaml
- assertVisible: "UPDATED!"

# Check for updates â€” server has disabled the release, triggers rollback to binary
- tapOn: "Check for updates"

# sync() detects disabled release, calls clearUpdates() + restartApp() automatically
- waitForAnimationToEnd:
    timeout: 30000

# After rollback, UPDATED! should be gone
- assertVisible: "React Native.*"
- assertNotVisible: "UPDATED!"
